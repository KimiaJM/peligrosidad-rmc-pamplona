"use strict";(self.webpackChunksitna_map_project_by_kimia_jimenez_majidi=self.webpackChunksitna_map_project_by_kimia_jimenez_majidi||[]).push([[5031,5924],{5031:(e,t,o)=>{o.r(t),o.d(t,{default:()=>p});var s=o(8038),n=o(5924),i=o(3301),r=o(797);let a;const l=new Map,c=function(e){let t=l.get(e);return!!t&&(t-=1,t<=0&&l.delete(e),!0)};class u extends n.default{constructor(){super(...arguments);const e=this;e.url=e.options.url||"//maps.googleapis.com/maps/api/js?v=3";const t=e.url.lastIndexOf("?");t<0?e.url+="?":t<e.url.length-1&&(e.url+="&");let o="SV_"+(Math.random()+1).toString(36).substring(7);globalThis[o]=function(){delete globalThis[o]},e.url+="key="+e.options.googleMapsKey+"&callback="+o,e.minimumElevation=e.options.minimumElevation||-9998,e.nativeCRS="EPSG:4326",e.maxCoordinateCountPerRequest=512,e.minRetryInterval=5100,e.maxRetries=Number.isInteger(e.options.maxRetries)?e.options.maxRetries:0}async request(e={}){const t=this;if(!t.options.googleMapsKey)return Promise.reject(Error("Missing Google Maps key"));const o=e.id,n={status:"CANCELLED"};let u,p=e.coordinates;if(u=1===p.length?r.A.geom.POINT:r.A.geom.POLYLINE,t.options.allowedGeometryTypes&&!t.options.allowedGeometryTypes.includes(u))return Promise.reject(Error(u+" geometry type not allowed by configuration"));if(p.length>t.maxCoordinateCountPerRequest){const s=[];for(var m=0,d=p.length;m<d;m+=t.maxCoordinateCountPerRequest)s.push(p.slice(m,m+t.maxCoordinateCountPerRequest));!function(e,t){let o=l.get(e)||0;o+=t,l.set(e,o)}(o,s.length);let r=0;const a=s.map((function s(a){const c=i.A.extend({},e,{coordinates:a,id:o});return new Promise((function(e,i){l.has(o)?t.request(c).then((function(c){"OVER_QUERY_LIMIT"===c.status?(console.log("OVER_QUERY_LIMIT status reached for request "+o),l.has(o)?!t.maxRetries||r<t.maxRetries?(r+=1,setTimeout((function(){s(a).then((t=>e(t))).catch((e=>i(e)))}),t.minRetryInterval)):e(c):e(n)):e(c)})).catch((e=>i(e))):e(n)}))})),u=await Promise.all(a),f=Array.prototype.concat.apply([],u.filter((e=>"OK"===e.status)).map((e=>e.elevations)));return c(o),{status:"OK",elevations:f}}e.crs&&e.crs!==t.nativeCRS&&(p=i.A.reproject(p,e.crs,t.nativeCRS));const f=globalThis.google&&globalThis.google.maps;f||(s.A.Cfg.proxyExceptions=s.A.Cfg.proxyExceptions||[],s.A.Cfg.proxyExceptions.push(t.url)),await s.A.loadJS(!f,t.url,null,!1,!0),a??=new google.maps.ElevationService;const g=p.map((e=>({lat:e[1],lng:e[0]}))),h=await a.getElevationForLocations({locations:g});return c(o),{status:"OK",elevations:h.results}}parseResponse(e,t){const o=this;return"OK"===e.status?e.elevations.map((function(e){return t.crs&&t.crs!==o.nativeCRS?i.A.reproject([e.location.lng(),e.location.lat()],o.nativeCRS,t.crs).concat(e.elevation):[e.location.lng(),e.location.lat(),e.elevation]})):[]}cancelRequest(e){l.delete(e)}}const p=u},5924:(e,t,o)=>{o.r(t),o.d(t,{default:()=>i});var s=o(8038),n=o(3301);const i=class{#e;#t;constructor(e){const t=this;t.options=e||{},t.url=t.options.url,t.process=t.options.process,t.minimumElevation=t.options.minimumElevation,n.A.isFunction(t.options.request)&&(t.request=t.options.request),n.A.isFunction(t.options.parseResponse)&&(t.parseResponse=t.options.parseResponse)}async getElevation(e={}){const t=this,o={...e};void 0===o.resolution&&(o.resolution=t.options.resolution),void 0===o.sampleNumber&&(o.sampleNumber=t.options.sampleNumber);const s=await t.request(e);return(o.responseCallback||t.parseResponse).call(t,s,o)}async request(e={}){const t=this;if(e.dataInputs||e.body){const{default:n}=await o.e(761).then(o.bind(o,761)),i={process:e.process||t.process,dataInputs:e.dataInputs,responseType:SITNA.Consts.mimeType.JSON,version:e.serviceVersion||t.serviceVersion||"1.0.0",output:e.output},r="boolean"==typeof e.contentType?e.contentType:e.contentType||SITNA.Consts.mimeType.XML;return(await s.A.ajax({url:t.url,method:"POST",contentType:r,responseType:SITNA.Consts.mimeType.JSON,data:e.body||n.buildExecuteQuery(i)})).data}throw Error("Request is not valid for elevation service")}parseResponse(e,t){var o=this;return e.coordinates&&e.coordinates.forEach((function(e){e[2]<o.minimumElevation&&(e[2]=null)})),e.coordinates||[]}cancelRequest(e){}async getProxificationTool(){if(!this.#e){this.#t||(this.#t=Promise.resolve().then(o.bind(o,8991)));const e=(await this.#t).default;this.#e=new e(s.A.proxify)}return this.#e}}}}]);